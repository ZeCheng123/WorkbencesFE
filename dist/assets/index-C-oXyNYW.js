import{u as B}from"./userinfo-DMWt4scE.js";import{w as C,s as U,l as x}from"./common-Df-r2Ss9.js";import{d as y,g as D,r,b as F,o as M,c as m,e as i,w as d,F as R,f as g,p as G,h as J,i as u,a as h,t as O,j as T,_ as X}from"./index-BciW1GB7.js";const Q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAYdJREFUSEu1lDFLA0EQhWcuCIIgin9AQSRBLAQbbbRNp4KFegfaaCEIlskmGNAkloIiKILh7gTRIjaKlbWNxELInljkF9gG0exIEhJNvE2yC7lyb+fbN483g9ClD7vEBS3wuJkeLRkiDEIMVYShUeAOy/wVqQyeWEkPfgXEh0+nz9xhU7VzZXDQ3EsAGrt+FgrChTc3eltpQtXjkJm8J4SwpG69ZokyOGglSSomYIzwTKSgpVgGJoQXz2aT+h5b+y4ArjarJsBDz4nuaIPLhSErdU1ASw3xEjSdv4w9aYMlqbjiDlvWzrEsakQi7Lnxh5bganFgFoDmyheJ4MRz2ZZf+1UQHnAnGmn2vB634bXEQG+p5w4AZv5fwptmT6tMyHKbLfrFrw4eM1PzBlJWZWC4w6RzUP/RalTb7YWWihXAZ9xhm+06+1VsJTcA4FRegI+I4jhvxzqyq8Ejn3EtAkCOSJx7bvyinUpp3GoLHAGKhEbuu7/v9f1o+1MFqD15nT6ivDY7Bf8ADkOHFwvZKY0AAAAASUVORK5CYII=",q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAihJREFUSEvN1E9o01AcB/Dv7yVZb0MFFQ/zMmbrpidXsEykguBBFCtOxBlF9KzCDqJdMWDrQBTBu0VMnSD4BwVRT70JdijI6hqVXRQsTLzMS9fk/ST749o1aSJSMMe87/vk9977vRA69FCHXISCtx7P7mZBoxA0SJJvb/xWv1ksGna7otrC245lexyVRplwvglhlARw42Mh/dAPb4Fjem4fWCZAYieABIBu38oIFZKYlMQlEBWte+kPy9kmOKpnhwnkW0XQeSgs+sqFS1/cXBMcO3HVAIkrQYDvOMs9lUKm+L/CVIagU2DeBObnC6v494qprEgcXd83/6k6oz0A48jfwHcrZvp0TM89A3BgZV8XUTuifCXbdtH9f8b8Ko7q2QsEurUUnFJYpFCrVZ2I9hKEIWARrXVhVrUxAfDexoN0IPs/m5nplsPbMjIeF0K+bQi/qaN+SCFVEyxeuSh1yTnHpgkGdq3qjncVM73Ds4+TSUP93qPNErBmZXn82l7bfTDy81ev1NQ6O/Z9gOMeLXe5YqbHPWH3Zexk7jEYqVUTH4HlFIRyGMzbvfqYwXHLHJv0hQfOGOucee09gM1hLwqD71jm2NnGvOdPaGDkWr8juBwOpjJrSsLKX5wLhN1AVM8OEqgUgP8Ay+HlaxwKdkO9urFBIy3f1KtLswnIS5bXrULG8vp44I8+aRhqdUY9R4wUAzEATwj8dNrMvGi3mkA43D63pjoG/waphdwXWEUOPAAAAABJRU5ErkJggg==",f=A=>(G("data-v-1486a718"),A=A(),J(),A),N=f(()=>u("div",{class:"main"},null,-1)),j={class:"content"},K=f(()=>u("img",{src:Q,alt:""},null,-1)),Y=f(()=>u("img",{src:q,alt:""},null,-1)),L={key:0,class:"sendCode"},P=y({__name:"index",setup(A){const{proxy:n}=D(),l=r(0);B();const S=r(null),v=r(null),w=r(null),p=r(!0),I=r({userId:"",corpId:"",token:""}),o=F({phone:"",code:""});M(()=>{const s=window.location.href.indexOf("?"),e=s>=0?window.location.href.substring(s+1):window.location.href,t=new URLSearchParams(e).get("code");t&&(alert("wxcode:"+t),v.value=t,E())});const k=()=>{if(!o.phone){n.$message.error("手机号不能为空!");return}if(!/^1[3-9]\d{9}$/.test(o.phone)){n.$message.error("手机号不合法!");return}U({phone:o.phone}).then(e=>{e.data.code=="success"&&(l.value=60,V())})},E=async()=>new Promise(function(s){C({code:v.value,userType:2}).then(e=>{let a=e.data;if(a.code=="success"){let t=a.data||{};I.value=t,I.value.token?(localStorage.setItem("token",t.token),sessionStorage.setItem("token",t.token),n.$router.push({path:"/main",query:{}})):(p.value=!0,S.value=o.phone)}s(!0)})}),_=()=>{if(!o.phone){n.$message.error("手机号不能为空!");return}if(!/^1[3-9]\d{9}$/.test(o.phone)){n.$message.error("手机号不合法!");return}if(!o.code){n.$message.error("验证码不能为空!");return}x({phone:o.phone,captcha:o.code,userType:1}).then(e=>{let a=e.data;if(a.code=="success"){let t=a.data||{};alert(JSON.stringify(t)),n.$router.push("/main")}else n.$message.error(e==null?void 0:e.message)})},V=()=>{w.value=setInterval(()=>{l.value>0?l.value-=1:clearInterval(w.value)},1e3)};return(s,e)=>{const a=g("el-input"),t=g("el-button"),b=g("el-dialog");return h(),m(R,null,[N,i(b,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=c=>p.value=c),title:"登录","close-on-click-modal":!1},{default:d(()=>[u("div",j,[i(a,{class:"phone",placeholder:"请输入手机号",modelValue:o.phone,"onUpdate:modelValue":e[0]||(e[0]=c=>o.phone=c)},{prepend:d(()=>[K]),_:1},8,["modelValue"]),i(a,{class:"code",placeholder:"请输入验证码",modelValue:o.code,"onUpdate:modelValue":e[1]||(e[1]=c=>o.code=c)},{prepend:d(()=>[Y]),append:d(()=>[l.value>0?(h(),m("span",L,O(l.value)+"s",1)):(h(),m("span",{key:1,class:"sendCode",onClick:k},"发送验证码"))]),_:1},8,["modelValue"]),i(t,{class:"login_btn",onClick:_},{default:d(()=>[T("登录")]),_:1})])]),_:1},8,["modelValue"])],64)}}}),H=X(P,[["__scopeId","data-v-1486a718"]]);export{H as default};
