import{_ as A,a as G,b as R}from"./tips-DfmWQaVF.js";import{d as W,g as H,r as p,y as K,k as Q,E as P,c as I,b as e,s as h,x as c,u as n,q as X,e as d,w as C,F as j,v as J,z as Y,f as N,p as Z,h as U,o as k,n as ee,i as se,_ as te}from"./index-zSdT-s-c.js";import{m as ae,c as oe}from"./common-Bv_4f9YQ.js";const a=w=>(Z("data-v-7d75c792"),w=w(),U(),w),ne={class:"main"},ce={class:"header"},le=a(()=>e("span",{class:"title"},"派工单状态",-1)),ie={class:"step"},de={class:"order_info"},_e=a(()=>e("span",{class:"title"},"派工单详情",-1)),pe={class:"main_field"},re={class:"row_field"},ue={class:"field"},he=a(()=>e("span",{class:"label"},"派工编号：",-1)),me={class:"value"},fe={class:"field"},ve=a(()=>e("span",{class:"label"},"派工类型：",-1)),xe={class:"value"},ge={class:"field"},be=a(()=>e("span",{class:"label"},"派工状态：",-1)),ye={class:"value"},Pe={class:"row_field"},Ce={class:"field"},ke=a(()=>e("span",{class:"label"},"服务技工：",-1)),we={class:"value"},Ee={class:"field"},Ie=a(()=>e("span",{class:"label"},"服务技工电话：",-1)),Ne={class:"value"},Se={class:"field"},Te=a(()=>e("span",{class:"label"},"客户地址：",-1)),Be={class:"value"},De={class:"row_field"},je={class:"field"},Je=a(()=>e("span",{class:"label"},"客户姓名：",-1)),$e={class:"value"},Fe={class:"field"},Ve=a(()=>e("span",{class:"label"},"客户电话：",-1)),Le={class:"value"},Oe=a(()=>e("span",{class:"title"},"派工要求",-1)),qe={class:"other_field"},ze={class:"row_field"},Me={class:"field"},Ae=a(()=>e("span",{class:"label"},"计划开始：",-1)),Ge={class:"value"},Re={class:"field"},We=a(()=>e("span",{class:"label"},"计划结束：",-1)),He={class:"value"},Ke={class:"field"},Qe=a(()=>e("span",{class:"label"},"优先级：",-1)),Xe={class:"value"},Ye={class:"row_field"},Ze={class:"field"},Ue=a(()=>e("span",{class:"label"},"是否具备安装条件：",-1)),es={class:"value"},ss={class:"service_evaluation_list"},ts=a(()=>e("span",{class:"table_title"},"服务评价",-1)),as={class:"table_content"},os=["onClick"],ns={class:"dispatch_attachment_list"},cs=a(()=>e("span",{class:"table_title"},"派工附件",-1)),ls={class:"table_content"},is={class:"action_list"},ds=a(()=>e("img",{src:A,alt:""},null,-1)),_s={class:"right"},ps={class:"userinfo"},rs=a(()=>e("img",{src:G,alt:""},null,-1)),us={class:"username"},hs={class:"content"},ms={class:"date"},fs=a(()=>e("span",{class:"reply"},"回复",-1)),vs=a(()=>e("img",{class:"tips",src:R,alt:""},null,-1)),xs=W({__name:"index",setup(w){H();const r=p(3),T=p([]),$=K();let o=p({});const S=p([]),F=p([{code:"1",name:"最高"},{code:"2",name:"高"},{code:"3",name:"中"},{code:"4",name:"低"}]),V=p([{code:"all",name:"全部"},{code:"0",name:"配送派工单"},{code:"1",name:"安装派工单"},{code:"2",name:"维修派工单"}]),L=p([{code:"all",name:"全部"},{code:"0",name:"待开始"},{code:"1",name:"进行中"},{code:"2",name:"已完成"}]);p([{text1:"CS0011-06665-01",text2:"门套",text3:"示例字段...",text4:"混油米灰1#",text5:"2021-02-28 10:30:50",text6:""},{text1:"CS0011-06665-01",text2:"门套",text3:"示例字段...",text4:"混油米灰1#",text5:"2021-02-28 10:30:50",text6:""},{text1:"CS0011-06665-01",text2:"门套",text3:"示例字段...",text4:"混油米灰1#",text5:"2021-02-28 10:30:50",text6:""}]);const O=p([{text1:"SU2024030101",text2:"已评价",text3:"示例字段...",text4:"李工",text5:"2021-02-28 10:30:50",text6:""}]),m=p([]),f=_=>{r.value=_},B=()=>{Y.prompt("请填写评论内容","发起评论",{inputPattern:/\S/,inputErrorMessage:"评论内容不能为空!",confirmButtonText:"确认",cancelButtonText:"取消"}).then(({value:_})=>{T.value.push({userName:"经销商",text:_,date:new Date().toLocaleString()})}).catch(()=>{})};Q(()=>{q(!0,$.query.id),z(!1)});const q=(_,i)=>{ae(i).then(l=>{let t=l.data.data;if(t!=null){o.value=t,f(t.stage__c);var u="https://sh.mengtian.com.cn:9595/md/api/common/file/direct-download?fileId=";if(t.goodsPicture!=null&&t.goodsPicture.length>0){var E=[];t.goodsPicture.forEach(s=>{E.push(u+s)}),m.value.push({picNo:t.goodsPicture.join(","),type:"货物图片",goodsPicture:E})}if(t.docPicture!=null&&t.docPicture.length>0){var v=[];t.docPicture.forEach(s=>{v.push(u+s)}),m.value.push({picNo:t.docPicture.join(","),type:"安装图片",goodsPicture:v})}if(t.checkInPicture!=null&&t.checkInPicture.length>0){var x=[];t.checkInPicture.forEach(s=>{x.push(u+s)}),m.value.push({picNo:t.checkInPicture.join(","),type:"打卡签到",goodsPicture:x})}if(t.scenePicture!=null&&t.scenePicture.length>0){var g=[];t.scenePicture.forEach(s=>{g.push(u+s)}),m.value.push({picNo:t.scenePicture.join(","),type:"现场墙面保护",goodsPicture:g})}if(t.afterInstallPicture!=null&&t.afterInstallPicture.length>0){var b=[];t.afterInstallPicture.forEach(s=>{b.push(u+s)}),m.value.push({picNo:t.afterInstallPicture.join(","),type:"安装后图片",goodsPicture:b})}if(t.completePicture!=null&&t.completePicture.length>0){var y=[];t.completePicture.forEach(s=>{y.push(u+s)}),m.value.push({picNo:t.completePicture.join(","),type:"完工证明",goodsPicture:y})}_&&P({message:"查询成功",type:"success"})}else _&&P({message:"获取数据失败",type:"error"})}).catch(l=>{P({message:"请求数据失败，请重试",type:"error"}),console.error("请求数据失败:",l)})},z=_=>{oe({userType:1,name:"",phone:""}).then(l=>{let t=l.data.data;t!=null&&t.length>0?(S.value=t,_&&P({message:"查询成功",type:"success"})):_&&P({message:"获取数据失败",type:"error"})})};return(_,i)=>{var v,x,g,b,y;const l=N("el-table-column"),t=N("el-table"),u=N("el-image"),E=N("el-button");return k(),I("div",ne,[e("span",ce,[le,e("span",ie,[e("span",{class:"item",onClick:i[0]||(i[0]=s=>f(0))},[e("span",{class:h(r.value==0?"num_selected":"num")},"1",2),e("span",{class:h(r.value>=0?"name_selected":"name")},"待开始",2)]),e("span",{class:"item",onClick:i[1]||(i[1]=s=>f(1))},[e("span",{class:h(r.value==1?"num_selected":"num")},"2",2),e("span",{class:h(r.value>=1?"name_selected":"name")},"进行中",2)]),e("span",{class:"item",onClick:i[2]||(i[2]=s=>f(2))},[e("span",{class:h(r.value==2?"num_selected":"num")},"3",2),e("span",{class:h(r.value>=2?"name_selected":"name")},"已完成",2)]),e("span",{class:"item",onClick:i[3]||(i[3]=s=>f(3))},[e("span",{class:h(r.value==3?"num_selected":"num")},"4",2),e("span",{class:h(r.value>=3?"name_selected":"name")},"已评价",2)])])]),e("span",de,[_e,e("span",pe,[e("span",re,[e("span",ue,[he,e("span",me,c(n(o).caseNo),1),X("",!0)]),e("span",fe,[ve,e("span",xe,c(n(o).fieldJobType__c?(v=V.value.find(s=>s.code==n(o).fieldJobType__c))==null?void 0:v.name:"配送派工单"),1)]),e("span",ge,[be,e("span",ye,c(n(o).stage__c?(x=L.value.find(s=>s.code==n(o).stage__c))==null?void 0:x.name:"待开始"),1)])]),e("span",Pe,[e("span",Ce,[ke,e("span",we,c(n(o).followerId?(g=S.value.find(s=>s.id==n(o).followerId))==null?void 0:g.name:""),1)]),e("span",Ee,[Ie,e("span",Ne,c(n(o).followerId?(b=S.value.find(s=>s.id==n(o).followerId))==null?void 0:b.phone:""),1)]),e("span",Se,[Te,e("span",Be,c(n(o).address),1)])]),e("span",De,[e("span",je,[Je,e("span",$e,c(n(o).fieldJobContactName),1)]),e("span",Fe,[Ve,e("span",Le,c(n(o).contactTelephone),1)])])]),Oe,e("span",qe,[e("span",ze,[e("span",Me,[Ae,e("span",Ge,c(n(o).appointmentStartTime),1)]),e("span",Re,[We,e("span",He,c(n(o).appointmentEndTime),1)]),e("span",Ke,[Qe,e("span",Xe,c(n(o).priority?(y=F.value.find(s=>s.code==n(o).priority))==null?void 0:y.name:""),1)])]),e("span",Ye,[e("span",Ze,[Ue,e("span",es,c(n(o).whetherEvaluation===!1?"否":"是"),1)])])])]),e("span",ss,[ts,e("span",as,[d(t,{data:O.value,stripe:!1,style:{width:"100%"}},{default:C(()=>[d(l,{prop:"text1",label:"服务评价号"}),d(l,{prop:"text2",label:"状态"}),d(l,{prop:"text3",label:"其它字段"}),d(l,{prop:"text4",label:"服务技工"}),d(l,{prop:"text6",label:"操作",width:"80px"},{default:C(s=>[e("div",{style:{display:"flex","align-items":"center",color:"#165dff",cursor:"pointer"},onClick:D=>console.log(s)}," 查看 ",8,os)]),_:1})]),_:1},8,["data"])])]),e("span",ns,[cs,e("span",ls,[d(t,{data:m.value,stripe:!1,style:{width:"100%"}},{default:C(()=>[d(l,{prop:"picNo",label:"附件编号"}),d(l,{prop:"type",label:"类型"}),d(l,{prop:"text3",label:"附件链接"},{default:C(({row:s})=>[(k(!0),I(j,null,J(s.goodsPicture,(D,M)=>(k(),ee(u,{key:M,style:{"margin-right":"5px",width:"50px"},src:D,"preview-src-list":s.goodsPicture},null,8,["src","preview-src-list"]))),128))]),_:1})]),_:1},8,["data"])])]),e("span",is,[e("div",{class:"left"},[ds,e("span",{class:"initiate_comments",onClick:B},"发起任务评论")]),e("div",_s,[d(E,{type:"primary",onClick:B,class:"primary_btn"},{default:C(()=>[se("编辑")]),_:1})])]),(k(!0),I(j,null,J(T.value,s=>(k(),I("div",{class:"comment",key:s.date},[e("div",ps,[rs,e("span",us,c(s.userName),1)]),e("div",hs,c(s.text),1),e("div",ms,c(s.date),1),fs,vs]))),128))])}}}),Ps=te(xs,[["__scopeId","data-v-7d75c792"]]);export{Ps as default};
