import{_ as ae,a as te,b as oe}from"./logoXX-Cy74BE6B.js";import{_ as se}from"./plus-B8sn_dc4.js";import{_ as ne}from"./download-Dan4AgsM.js";import{d as re,g as ue,r as u,b as de,o as ce,c as C,i as o,e as l,w as t,f as d,p as ie,h as pe,a as h,F as I,m as $,q as z,j as _,t as R,v as O,u as me,x as _e,_ as fe}from"./index-Ca3ktP95.js";import{y as be,z as ve,e as ge}from"./common-CN53Xqpj.js";import"./userinfo-CWw1Q2oY.js";const p=N=>(ie("data-v-8ecefb39"),N=N(),pe(),N),he={class:"main"},Ne=p(()=>o("span",{class:"header"},[o("span",{class:"title"},"服务评价")],-1)),Ve={class:"search"},ye={class:"left"},Pe=p(()=>o("span",{style:{width:"336px",height:"32px"}},null,-1)),Se={class:"right"},xe=p(()=>o("img",{src:te,alt:""},null,-1)),we=p(()=>o("img",{src:oe,alt:""},null,-1)),Ce={class:"table_header"},ke=p(()=>o("span",{class:"left"},[o("img",{src:ae,alt:""}),o("span",{class:"title"})],-1)),De={class:"right"},Le=p(()=>o("img",{src:se,alt:""},null,-1)),Ue=p(()=>o("img",{src:ne,alt:""},null,-1)),Ie={class:"table"},$e={style:{display:"flex","align-items":"center"}},ze={style:{display:"flex","align-items":"center"}},Re=["onClick"],Oe={class:"problemReportingDialog"},Te={class:"step"},qe={class:"item"},Be=p(()=>o("span",{class:"name"},[_("完善提报信息 "),o("span",{class:"remark"},"完善问题提报的信息")],-1)),Fe={class:"item"},je=p(()=>o("span",{class:"name"},[_("完成创建 "),o("span",{class:"remark"},"等待售服部处理")],-1)),Ae={class:"content"},Me={class:"dialog-footer"},Ee=re({__name:"index",setup(N){const{proxy:f}=ue(),V=u({pageIndex:0,pageSize:100,total:0}),T=u({Content:"application/json",Authorization:"",isImage:"true",needFileId:"true","Trace-Id":""}),k=u({files:[],name:"files"}),c=de({problemNo:"",customerName:"",customerPhone:"",filterMethod:"",createDate:[],orderStatus:""});u([{value:"all",label:"全部"}]);const q=u([{value:"all",label:"全部"}]),B=u([{name:"品质",code:"1"},{name:"交期",code:"2"},{name:"服务",code:"3"},{name:"销售",code:"4"}]),F=u([{name:"待分配",code:"1"},{name:"待处理",code:"2"},{name:"处理中",code:"3"},{name:"待回复",code:"4"},{name:"已完成",code:"4"}]),g=u(!1),D=u(1),n=u({orderNo:"",customerName:"",customerPhone:"",desc:"",fileList:[],filePath:[]}),j=u({customerName:[{required:!0,message:"Please input customer name",trigger:"blur"}],customerPhone:[{required:!0,message:"Please input customer phone",trigger:"blur"}],desc:[{required:!0,message:"Please input problem description",trigger:"blur"}]}),y=u([]),P=u([]);ce(()=>{setTimeout(()=>{S(),G()},500)});const A=r=>{let e=r.id,s=r.neoid;f.$router.push(`/problem_report_details?id=${e}&neoid=${s}`)},M=()=>{g.value=!0},E=()=>{for(let e in n.value)if(e!="fileList"&&e!="orderNo"&&n.value[e]==""){f.$message.error("必填字段不能为空!");return}let r={caseNo:n.value.orderNo,name:n.value.customerName,phone:n.value.customerPhone,problemDescription:n.value.desc,picture:n.value.filePath.join(";"),caseStatus:"1"};ge(r).then(e=>{let s=e.data;s.code=="success"?(n.value={orderNo:"",customerName:"",customerPhone:"",desc:"",fileList:[],filePath:[]},g.value=!1,f.$message.success("提交成功!"),S()):f.$message.error(s==null?void 0:s.message)})},S=()=>{be({caseStatus:"",caseNo:"",name:""}).then(e=>{let s=e.data;s.code=="success"?(y.value=s.data,V.value={pageIndex:0,pageSize:100,total:s.data.length}):(f.$message.error(s==null?void 0:s.message),y.value=[],V.value={pageIndex:0,pageSize:100,total:0})})},G=()=>{ve({deliveryDate:"",status__c:"",orderType__c:"",transactionDate:"",po:"",accountName:"",accountPhone:""}).then(e=>{let s=e.data;s.code=="success"?P.value=s.data:f.$message.error(s==null?void 0:s.message)})},H=r=>{let e=P.value.find(s=>s.po==r);e&&(n.value.customerName=e.accountName,n.value.customerPhone=e.accountPhone)},J=r=>{if(console.log(r),r.code=="success"){let e=r.data.map(s=>s.fileUrl);n.value.filePath=n.value.filePath.concat(e)}},K=r=>{var e=r.response;console.log(e)},Q=r=>{k.value.files.push(r)};return(r,e)=>{const s=d("el-input"),i=d("el-form-item"),x=d("el-form"),W=d("el-date-picker"),L=d("el-option"),U=d("el-select"),b=d("el-button"),m=d("el-table-column"),X=d("el-table"),Y=d("el-pagination"),Z=d("el-icon"),ee=d("el-upload"),le=d("el-dialog");return h(),C("div",he,[Ne,o("span",Ve,[o("span",ye,[l(x,{model:c,rules:r.rule,"label-width":"80px","label-position":"left"},{default:t(()=>[l(i,{label:"问题编号"},{default:t(()=>[l(s,{placeholder:"请输入问题编号",modelValue:c.problemNo,"onUpdate:modelValue":e[0]||(e[0]=a=>c.problemNo=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"客户名称"},{default:t(()=>[l(s,{placeholder:"输入客户名称",modelValue:c.customerName,"onUpdate:modelValue":e[1]||(e[1]=a=>c.customerName=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"客户电话"},{default:t(()=>[l(s,{placeholder:"请输入客户电话",modelValue:c.customerName,"onUpdate:modelValue":e[2]||(e[2]=a=>c.customerName=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),l(x,{model:c,rules:r.rule,"label-width":"80px","label-position":"left"},{default:t(()=>[l(i,{label:"创建时间"},{default:t(()=>[l(W,{modelValue:c.createDate,"onUpdate:modelValue":e[3]||(e[3]=a=>c.createDate=a),type:"daterange","range-separator":"~","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])]),_:1}),l(i,{label:"订单状态"},{default:t(()=>[l(U,{modelValue:c.orderStatus,"onUpdate:modelValue":e[4]||(e[4]=a=>c.orderStatus=a),placeholder:"请选择订单状态"},{default:t(()=>[(h(!0),C(I,null,$(q.value,a=>(h(),z(L,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Pe]),_:1},8,["model","rules"])]),o("span",Se,[l(b,{type:"primary",onClick:S,class:"search_btn"},{icon:t(()=>[xe]),default:t(()=>[_("查询")]),_:1}),l(b,{type:"primary",class:"reset_btn"},{icon:t(()=>[we]),default:t(()=>[_("重置")]),_:1})])]),o("span",Ce,[ke,o("span",De,[l(b,{onClick:M,type:"primary",class:"search_btn"},{icon:t(()=>[Le]),default:t(()=>[_("新建")]),_:1}),l(b,{type:"primary",class:"reset_btn"},{icon:t(()=>[Ue]),default:t(()=>[_("下载")]),_:1})])]),o("span",Ie,[l(X,{class:"table_content",data:y.value,stripe:!1,style:{width:"100%"}},{default:t(()=>[l(m,{prop:"caseNo",label:"问题编号"}),l(m,{prop:"caseAccountId",label:"客户姓名"}),l(m,{prop:"problemDescription",label:"问题描述"}),l(m,{prop:"sourceOfProblem",label:"来源"},{default:t(a=>{var v;return[o("div",$e,R(a.row.sourceOfProblem?(v=B.value.find(w=>w.code==a.row.sourceOfProblem))==null?void 0:v.name:""),1)]}),_:1}),l(m,{prop:"distributorName",label:"提报人"}),l(m,{prop:"actualResolutionDate",label:"创建时间"}),l(m,{prop:"caseStatus",label:"问题状态"},{default:t(a=>{var v;return[o("div",ze,R(a.row.caseStatus?(v=F.value.find(w=>w.code==a.row.caseStatus))==null?void 0:v.name:""),1)]}),_:1}),l(m,{prop:"",label:"操作",width:"80px"},{default:t(a=>[o("div",{style:{display:"flex","align-items":"center",color:"#165dff",cursor:"pointer"},onClick:v=>A(a.row)}," 查看 ",8,Re)]),_:1})]),_:1},8,["data"]),l(Y,{class:"table_pagination","page-size":V.value.pageSize,"pager-count":5,layout:"total, prev, pager, next",total:V.value.total},null,8,["page-size","total"])]),o("div",Oe,[l(le,{modelValue:g.value,"onUpdate:modelValue":e[11]||(e[11]=a=>g.value=a),title:"问题提报",width:"80%","show-close":!1},{footer:t(()=>[o("div",Me,[l(b,{class:"cancel_btn",onClick:e[10]||(e[10]=a=>g.value=!1)},{default:t(()=>[_("取消")]),_:1}),l(b,{type:"primary",class:"primary_btn",onClick:E},{default:t(()=>[_("提交")]),_:1})])]),default:t(()=>[o("span",Te,[o("span",qe,[o("span",{class:O(D.value==1?"num_selected":"num")},"1",2),Be]),o("span",Fe,[o("span",{class:O(D.value==2?"num_selected":"num")},"2",2),je])]),o("div",Ae,[l(x,{model:n.value,rules:j.value,"label-width":"90px","label-position":"left"},{default:t(()=>[l(i,{label:"订单编号",prop:"orderNo"},{default:t(()=>[l(U,{modelValue:n.value.orderNo,"onUpdate:modelValue":e[5]||(e[5]=a=>n.value.orderNo=a),filterable:"",onChange:H,placeholder:"请选择订单编号"},{default:t(()=>[(h(!0),C(I,null,$(P.value,a=>(h(),z(L,{key:a.po,label:a.po,value:a.po},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"客户姓名",prop:"customerName"},{default:t(()=>[l(s,{placeholder:"请输入客户姓名",modelValue:n.value.customerName,"onUpdate:modelValue":e[6]||(e[6]=a=>n.value.customerName=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"客户电话",prop:"customerPhone"},{default:t(()=>[l(s,{placeholder:"请输入客户电话",modelValue:n.value.customerPhone,"onUpdate:modelValue":e[7]||(e[7]=a=>n.value.customerPhone=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"问题描述",class:"customLayout",prop:"desc"},{default:t(()=>[l(s,{modelValue:n.value.desc,"onUpdate:modelValue":e[8]||(e[8]=a=>n.value.desc=a),rows:5,type:"textarea",maxlength:"500",placeholder:"请输入问题描述","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(i,{label:"上传图片",class:"custom_upload"},{default:t(()=>[l(ee,{"on-success":J,"on-remove":K,"auto-upload":!0,data:k.value,headers:T.value,"before-upload":Q,"list-type":"picture-card",class:"avatar-uploader",action:"https://sh.mengtian.com.cn:9595/md/api/common/file/upload","show-file-list":!0,"file-list":n.value.fileList,"onUpdate:fileList":e[9]||(e[9]=a=>n.value.fileList=a)},{default:t(()=>[l(Z,null,{default:t(()=>[l(me(_e))]),_:1})]),_:1},8,["data","headers","file-list"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])])])}}}),Xe=fe(Ee,[["__scopeId","data-v-8ecefb39"]]);export{Xe as default};
