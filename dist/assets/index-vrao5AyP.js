import{_ as oe,a as te,b as se}from"./logoXX-Cy74BE6B.js";import{_ as ne}from"./plus-B8sn_dc4.js";import{_ as re}from"./download-Dan4AgsM.js";import{d as ue,g as de,r as c,a as ce,k as ie,S as pe,T as me,c as C,b as s,e as l,w as o,f as i,p as _e,h as fe,o as h,F as I,A as $,n as R,i as _,t as z,v as T,x as be,y as ge,J as ve,_ as he}from"./index-W4iu8axL.js";const p=N=>(_e("data-v-0bcfbbac"),N=N(),fe(),N),Ne={class:"main"},ye=p(()=>s("span",{class:"header"},[s("span",{class:"title"},"问题提报")],-1)),Ve={class:"search"},Se={class:"left"},Pe=p(()=>s("span",{style:{width:"336px",height:"32px"}},null,-1)),xe={class:"right"},we=p(()=>s("img",{src:te,alt:""},null,-1)),Ce=p(()=>s("img",{src:se,alt:""},null,-1)),ke={class:"table_header"},De=p(()=>s("span",{class:"left"},[s("img",{src:oe,alt:""}),s("span",{class:"title"})],-1)),Le={class:"right"},Ue=p(()=>s("img",{src:ne,alt:""},null,-1)),Ie=p(()=>s("img",{src:re,alt:""},null,-1)),$e={class:"table"},Re={style:{display:"flex","align-items":"center"}},ze={style:{display:"flex","align-items":"center"}},Te=["onClick"],Oe={class:"problemReportingDialog"},Fe={class:"step"},qe={class:"item"},Be=p(()=>s("span",{class:"name"},[_("完善提报信息 "),s("span",{class:"remark"},"完善问题提报的信息")],-1)),Me={class:"item"},Ae=p(()=>s("span",{class:"name"},[_("完成创建 "),s("span",{class:"remark"},"等待售服部处理")],-1)),je={class:"content"},Ee={class:"dialog-footer"},Je=ue({__name:"index",setup(N){const{proxy:f}=de(),y=c({pageIndex:0,pageSize:100,total:0}),O=c({Content:"application/json",Authorization:"",isImage:"true",needFileId:"true","Trace-Id":""}),k=c({files:[],name:"files"}),r=ce({problemNo:"",customerName:"",customerPhone:"",filterMethod:"",createDate:[],tableData:[],orderStatus:""});c([{value:"all",label:"全部"}]);const F=c([{value:"all",label:"全部"}]),q=c([{name:"配送技工",code:"1"},{name:"安装技工",code:"2"},{name:"终端用户",code:"3"},{name:"经销商",code:"4"}]),B=c([{name:"待分配",code:"1"},{name:"待处理",code:"2"},{name:"处理中",code:"3"},{name:"待回复",code:"4"},{name:"已完成",code:"4"}]),v=c(!1),D=c(1),n=c({orderNo:"",customerName:"",customerPhone:"",desc:"",fileList:[],filePath:[]}),M=c({customerName:[{required:!0,message:"客户姓名不能为空！",trigger:"blur"}],customerPhone:[{required:!0,message:"客户电话不能为空！",trigger:"blur"}],desc:[{required:!0,message:"问题描述不能为空！",trigger:"blur"}]}),S=c([]),P=c([]);ie(()=>{setTimeout(()=>{V(),J()},500)});const A=u=>{let e=u.id,t=u.neoid,d="id="+e;t!=null&&(d=d+"&neoid="+t),f.$router.push(`/problem_report_details?${d}`)},j=()=>{v.value=!0},E=()=>{console.log("problemReportingForm",n.value);for(let e in n.value)if(e!="orderNo"&&e!="fileList"&&e!="filePath"&&n.value[e]==""){f.$message.error("必填字段不能为空!");return}let u={caseNo:n.value.orderNo,name:n.value.customerName,phone:n.value.customerPhone,problemDescription:n.value.desc,picture:n.value.filePath,caseStatus:"1",questionType:1};ve(u).then(e=>{let t=e.data;t.code=="success"?(n.value={orderNo:"",customerName:"",customerPhone:"",desc:"",fileList:[],filePath:[]},v.value=!1,f.$message.success("提交成功!"),V()):f.$message.error(t==null?void 0:t.message)})},V=()=>{let u={caseStatus:"",caseNo:r.problemNo,name:r.customerName};pe(u).then(e=>{let t=e.data;t.code=="success"?(S.value=t.data,y.value={pageIndex:0,pageSize:100,total:t.data.length}):(f.$message.error(t==null?void 0:t.message),S.value=[],y.value={pageIndex:0,pageSize:100,total:0})})},J=()=>{me({deliveryDate:"",status__c:"",orderType__c:"",transactionDate:"",po:"",accountName:"",accountPhone:""}).then(e=>{let t=e.data;t.code=="success"?P.value=t.data:f.$message.error(t==null?void 0:t.message)})},G=u=>{let e=P.value.find(t=>t.po==u);e&&(n.value.customerName=e.accountName,n.value.customerPhone=e.accountPhone)},H=u=>{if(console.log(u),u.code=="success"){let e=u.data.map(t=>t.fileId);n.value.filePath=n.value.filePath.concat(e),console.log(n.value.filePath)}},K=u=>{var e=u.response;console.log(e)},Q=u=>{k.value.files=[u]},W=()=>{console.log("aaaa"),r.problemNo=null,r.customerName=null,r.customerPhone=null,r.filterMethod=null,r.createDate=[],r.orderStatus=null,V()};return(u,e)=>{const t=i("el-input"),d=i("el-form-item"),x=i("el-form"),X=i("el-date-picker"),L=i("el-option"),U=i("el-select"),b=i("el-button"),m=i("el-table-column"),Y=i("el-table"),Z=i("el-pagination"),ee=i("el-icon"),le=i("el-upload"),ae=i("el-dialog");return h(),C("div",Ne,[ye,s("span",Ve,[s("span",Se,[l(x,{model:r,rules:u.rule,"label-width":"80px","label-position":"left"},{default:o(()=>[l(d,{label:"问题编号"},{default:o(()=>[l(t,{placeholder:"请输入问题编号",modelValue:r.problemNo,"onUpdate:modelValue":e[0]||(e[0]=a=>r.problemNo=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"客户名称"},{default:o(()=>[l(t,{placeholder:"输入客户名称",modelValue:r.customerName,"onUpdate:modelValue":e[1]||(e[1]=a=>r.customerName=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"客户电话"},{default:o(()=>[l(t,{placeholder:"请输入客户电话",modelValue:r.customerName,"onUpdate:modelValue":e[2]||(e[2]=a=>r.customerName=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),l(x,{model:r,rules:u.rule,"label-width":"80px","label-position":"left"},{default:o(()=>[l(d,{label:"创建时间"},{default:o(()=>[l(X,{modelValue:r.createDate,"onUpdate:modelValue":e[3]||(e[3]=a=>r.createDate=a),type:"daterange","range-separator":"~","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])]),_:1}),l(d,{label:"订单状态"},{default:o(()=>[l(U,{modelValue:r.orderStatus,"onUpdate:modelValue":e[4]||(e[4]=a=>r.orderStatus=a),placeholder:"请选择订单状态"},{default:o(()=>[(h(!0),C(I,null,$(F.value,a=>(h(),R(L,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Pe]),_:1},8,["model","rules"])]),s("span",xe,[l(b,{type:"primary",onClick:V,class:"search_btn"},{icon:o(()=>[we]),default:o(()=>[_("查询")]),_:1}),l(b,{type:"primary",onClick:e[5]||(e[5]=a=>W()),class:"reset_btn"},{icon:o(()=>[Ce]),default:o(()=>[_("重置")]),_:1})])]),s("span",ke,[De,s("span",Le,[l(b,{onClick:j,type:"primary",class:"search_btn"},{icon:o(()=>[Ue]),default:o(()=>[_("新建")]),_:1}),l(b,{type:"primary",class:"reset_btn"},{icon:o(()=>[Ie]),default:o(()=>[_("下载")]),_:1})])]),s("span",$e,[l(Y,{class:"table_content",data:S.value,stripe:!1,style:{width:"100%"}},{default:o(()=>[l(m,{prop:"caseNo",label:"问题编号"}),l(m,{prop:"name",label:"客户姓名"}),l(m,{prop:"problemDescription",label:"问题描述"}),l(m,{prop:"complaintSourceC",label:"来源"},{default:o(a=>{var g;return[s("div",Re,z(a.row.sourceOfProblem?(g=q.value.find(w=>w.code==a.row.sourceOfProblem))==null?void 0:g.name:""),1)]}),_:1}),l(m,{prop:"externalUserName",label:"提报人"}),l(m,{prop:"createdTime",label:"创建时间"}),l(m,{prop:"caseStatus",label:"问题状态"},{default:o(a=>{var g;return[s("div",ze,z(a.row.caseStatus?(g=B.value.find(w=>w.code==a.row.caseStatus))==null?void 0:g.name:""),1)]}),_:1}),l(m,{prop:"",label:"操作",width:"80px"},{default:o(a=>[s("div",{style:{display:"flex","align-items":"center",color:"#165dff",cursor:"pointer"},onClick:g=>A(a.row)}," 查看 ",8,Te)]),_:1})]),_:1},8,["data"]),l(Z,{class:"table_pagination","page-size":y.value.pageSize,"pager-count":5,layout:"total, prev, pager, next",total:y.value.total},null,8,["page-size","total"])]),s("div",Oe,[l(ae,{modelValue:v.value,"onUpdate:modelValue":e[12]||(e[12]=a=>v.value=a),title:"问题提报",width:"80%","show-close":!1},{footer:o(()=>[s("div",Ee,[l(b,{class:"cancel_btn",onClick:e[11]||(e[11]=a=>v.value=!1)},{default:o(()=>[_("取消")]),_:1}),l(b,{type:"primary",class:"primary_btn",onClick:E},{default:o(()=>[_("提交")]),_:1})])]),default:o(()=>[s("span",Fe,[s("span",qe,[s("span",{class:T(D.value==1?"num_selected":"num")},"1",2),Be]),s("span",Me,[s("span",{class:T(D.value==2?"num_selected":"num")},"2",2),Ae])]),s("div",je,[l(x,{model:n.value,rules:M.value,"label-width":"90px","label-position":"left"},{default:o(()=>[l(d,{label:"订单编号",prop:"orderNo"},{default:o(()=>[l(U,{modelValue:n.value.orderNo,"onUpdate:modelValue":e[6]||(e[6]=a=>n.value.orderNo=a),filterable:"",onChange:G,placeholder:"请选择订单编号"},{default:o(()=>[(h(!0),C(I,null,$(P.value,a=>(h(),R(L,{key:a.po,label:a.po,value:a.po},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"提报人姓名",prop:"customerName"},{default:o(()=>[l(t,{placeholder:"请输入提报人姓名",modelValue:n.value.customerName,"onUpdate:modelValue":e[7]||(e[7]=a=>n.value.customerName=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"提报人电话",prop:"customerPhone"},{default:o(()=>[l(t,{placeholder:"请输入提报人电话",modelValue:n.value.customerPhone,"onUpdate:modelValue":e[8]||(e[8]=a=>n.value.customerPhone=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"问题描述",class:"customLayout",prop:"desc"},{default:o(()=>[l(t,{modelValue:n.value.desc,"onUpdate:modelValue":e[9]||(e[9]=a=>n.value.desc=a),rows:5,type:"textarea",maxlength:"500",placeholder:"请输入问题描述","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(d,{label:"上传图片",class:"custom_upload"},{default:o(()=>[l(le,{"on-success":H,"on-remove":K,"auto-upload":!0,data:k.value,headers:O.value,"before-upload":Q,"list-type":"picture-card",class:"avatar-uploader",action:"https://sh.mengtian.com.cn:9595/md/api/common/file/upload","show-file-list":!0,"file-list":n.value.fileList,"onUpdate:fileList":e[10]||(e[10]=a=>n.value.fileList=a)},{default:o(()=>[l(ee,null,{default:o(()=>[l(be(ge))]),_:1})]),_:1},8,["data","headers","file-list"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])])])}}}),We=he(Je,[["__scopeId","data-v-0bcfbbac"]]);export{We as default};
