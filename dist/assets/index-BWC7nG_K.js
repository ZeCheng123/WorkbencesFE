import{u as U}from"./userinfo-CU9lpgZY.js";import{w as x,s as B,l as C,a as D}from"./common-DoACQn11.js";import{d as F,g as M,r as l,b as R,o as J,c as g,e as A,w as d,F as O,f,p as T,h as G,i as p,a as v,t as N,j as X,_ as Q}from"./index-k7gRZT9c.js";const q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAYdJREFUSEu1lDFLA0EQhWcuCIIgin9AQSRBLAQbbbRNp4KFegfaaCEIlskmGNAkloIiKILh7gTRIjaKlbWNxELInljkF9gG0exIEhJNvE2yC7lyb+fbN483g9ClD7vEBS3wuJkeLRkiDEIMVYShUeAOy/wVqQyeWEkPfgXEh0+nz9xhU7VzZXDQ3EsAGrt+FgrChTc3eltpQtXjkJm8J4SwpG69ZokyOGglSSomYIzwTKSgpVgGJoQXz2aT+h5b+y4ArjarJsBDz4nuaIPLhSErdU1ASw3xEjSdv4w9aYMlqbjiDlvWzrEsakQi7Lnxh5bganFgFoDmyheJ4MRz2ZZf+1UQHnAnGmn2vB634bXEQG+p5w4AZv5fwptmT6tMyHKbLfrFrw4eM1PzBlJWZWC4w6RzUP/RalTb7YWWihXAZ9xhm+06+1VsJTcA4FRegI+I4jhvxzqyq8Ejn3EtAkCOSJx7bvyinUpp3GoLHAGKhEbuu7/v9f1o+1MFqD15nT6ivDY7Bf8ADkOHFwvZKY0AAAAASUVORK5CYII=",j="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAihJREFUSEvN1E9o01AcB/Dv7yVZb0MFFQ/zMmbrpidXsEykguBBFCtOxBlF9KzCDqJdMWDrQBTBu0VMnSD4BwVRT70JdijI6hqVXRQsTLzMS9fk/ST749o1aSJSMMe87/vk9977vRA69FCHXISCtx7P7mZBoxA0SJJvb/xWv1ksGna7otrC245lexyVRplwvglhlARw42Mh/dAPb4Fjem4fWCZAYieABIBu38oIFZKYlMQlEBWte+kPy9kmOKpnhwnkW0XQeSgs+sqFS1/cXBMcO3HVAIkrQYDvOMs9lUKm+L/CVIagU2DeBObnC6v494qprEgcXd83/6k6oz0A48jfwHcrZvp0TM89A3BgZV8XUTuifCXbdtH9f8b8Ko7q2QsEurUUnFJYpFCrVZ2I9hKEIWARrXVhVrUxAfDexoN0IPs/m5nplsPbMjIeF0K+bQi/qaN+SCFVEyxeuSh1yTnHpgkGdq3qjncVM73Ds4+TSUP93qPNErBmZXn82l7bfTDy81ev1NQ6O/Z9gOMeLXe5YqbHPWH3Zexk7jEYqVUTH4HlFIRyGMzbvfqYwXHLHJv0hQfOGOucee09gM1hLwqD71jm2NnGvOdPaGDkWr8juBwOpjJrSsLKX5wLhN1AVM8OEqgUgP8Ay+HlaxwKdkO9urFBIy3f1KtLswnIS5bXrULG8vp44I8+aRhqdUY9R4wUAzEATwj8dNrMvGi3mkA43D63pjoG/waphdwXWEUOPAAAAABJRU5ErkJggg==",I=i=>(T("data-v-c895c6e4"),i=i(),G(),i),K=I(()=>p("div",{class:"main"},null,-1)),Y={class:"content"},L=I(()=>p("img",{src:q,alt:""},null,-1)),P=I(()=>p("img",{src:j,alt:""},null,-1)),W={key:0,class:"sendCode"},Z=F({__name:"index",setup(i){const{proxy:s}=M(),r=l(0);U();const m=l(null),w=l(null),S=l(null),h=l(!0),u=l({userId:"",corpId:"",token:""}),a=R({phone:"",code:""});J(()=>{const n=window.location.href.indexOf("?"),e=n>=0?window.location.href.substring(n+1):window.location.href,t=new URLSearchParams(e).get("code");t&&(alert("wxcode:"+t),w.value=t,E())});const k=()=>{if(!a.phone){s.$message.error("手机号不能为空!");return}if(!/^1[3-9]\d{9}$/.test(a.phone)){s.$message.error("手机号不合法!");return}B({phone:a.phone}).then(e=>{e.data.code=="success"&&(r.value=60,b())})},E=async()=>new Promise(function(n){x({code:w.value,userType:2}).then(e=>{let o=e.data;if(o.code=="success"){let t=o.data||{};u.value=t,u.value.token?(localStorage.setItem("token",t.token),sessionStorage.setItem("token",t.token),s.$router.push({path:"/main",query:{}})):(h.value=!0,m.value=a.phone)}n(!0)})}),_=()=>{if(!a.phone){s.$message.error("手机号不能为空!");return}if(!/^1[3-9]\d{9}$/.test(a.phone)){s.$message.error("手机号不合法!");return}if(!a.code){s.$message.error("验证码不能为空!");return}C({phone:a.phone,captcha:a.code,userType:2}).then(e=>{let o=e.data;if(o.code=="success"){let t=o.data||{};alert(JSON.stringify(t)),V(t),s.$router.push("/main")}else s.$message.error(e==null?void 0:e.message)})},V=async n=>{let e={id:n.id,neoId:n.neoId,phone:m.value,name:m.value,corpId:u.value.corpId,userId:u.value.userId,userType:2};alert("新增用户接口参数:"+JSON.stringify(e)),D(e).then(o=>{var t;alert(JSON.stringify(o.data)),((t=o==null?void 0:o.data)==null?void 0:t.code)=="success"?E():console.log("失败")}).catch(o=>{alert("新增失败!"),console.error("新增失败:",o)})},b=()=>{S.value=setInterval(()=>{r.value>0?r.value-=1:clearInterval(S.value)},1e3)};return(n,e)=>{const o=f("el-input"),t=f("el-button"),y=f("el-dialog");return v(),g(O,null,[K,A(y,{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=c=>h.value=c),title:"登录","close-on-click-modal":!1,"show-close":!1},{default:d(()=>[p("div",Y,[A(o,{class:"phone",placeholder:"请输入手机号",modelValue:a.phone,"onUpdate:modelValue":e[0]||(e[0]=c=>a.phone=c)},{prepend:d(()=>[L]),_:1},8,["modelValue"]),A(o,{class:"code",placeholder:"请输入验证码",modelValue:a.code,"onUpdate:modelValue":e[1]||(e[1]=c=>a.code=c)},{prepend:d(()=>[P]),append:d(()=>[r.value>0?(v(),g("span",W,N(r.value)+"s",1)):(v(),g("span",{key:1,class:"sendCode",onClick:k},"发送验证码"))]),_:1},8,["modelValue"]),A(t,{class:"login_btn",onClick:_},{default:d(()=>[X("登录")]),_:1})])]),_:1},8,["modelValue"])],64)}}}),ee=Q(Z,[["__scopeId","data-v-c895c6e4"]]);export{ee as default};
