import{_ as ae,a as te,b as oe,c as se}from"./download-B3fRz18S.js";import{_ as ne}from"./plus-B8sn_dc4.js";import{d as re,g as ue,r as d,a as de,k as ce,c as k,b as s,e as l,w as t,f as c,p as ie,h as pe,o as h,F as I,v as $,n as R,i as _,x as z,s as O,u as me,t as _e,_ as fe}from"./index-zSdT-s-c.js";import{n as ve,e as ge,i as be}from"./common-Bv_4f9YQ.js";const p=N=>(ie("data-v-3a5c786c"),N=N(),pe(),N),he={class:"main"},Ne=p(()=>s("span",{class:"header"},[s("span",{class:"title"},"问题提报")],-1)),Ve={class:"search"},ye={class:"left"},Pe=p(()=>s("span",{style:{width:"336px",height:"32px"}},null,-1)),Se={class:"right"},xe=p(()=>s("img",{src:te,alt:""},null,-1)),we=p(()=>s("img",{src:oe,alt:""},null,-1)),ke={class:"table_header"},Ce=p(()=>s("span",{class:"left"},[s("img",{src:ae,alt:""}),s("span",{class:"title"})],-1)),De={class:"right"},Le=p(()=>s("img",{src:ne,alt:""},null,-1)),Ue=p(()=>s("img",{src:se,alt:""},null,-1)),Ie={class:"table"},$e={style:{display:"flex","align-items":"center"}},Re={style:{display:"flex","align-items":"center"}},ze=["onClick"],Oe={class:"problemReportingDialog"},Te={class:"step"},Be={class:"item"},Fe=p(()=>s("span",{class:"name"},[_("完善提报信息 "),s("span",{class:"remark"},"完善问题提报的信息")],-1)),qe={class:"item"},je=p(()=>s("span",{class:"name"},[_("完成创建 "),s("span",{class:"remark"},"等待售服部处理")],-1)),Me={class:"content"},Ae={class:"dialog-footer"},Ee=re({__name:"index",setup(N){const{proxy:f}=ue(),V=d({pageIndex:0,pageSize:100,total:0}),T=d({Content:"application/json",Authorization:"",isImage:"true",needFileId:"true","Trace-Id":""}),C=d({files:[],name:"files"}),i=de({problemNo:"",customerName:"",customerPhone:"",filterMethod:"",createDate:[],orderStatus:""});d([{value:"all",label:"全部"}]);const B=d([{value:"all",label:"全部"}]),F=d([{name:"品质",code:"1"},{name:"交期",code:"2"},{name:"服务",code:"3"},{name:"销售",code:"4"}]),q=d([{name:"待分配",code:"1"},{name:"待处理",code:"2"},{name:"处理中",code:"3"},{name:"待回复",code:"4"},{name:"已完成",code:"4"}]),b=d(!1),D=d(1),n=d({orderNo:"",customerName:"",customerPhone:"",desc:"",fileList:[],filePath:[]}),j=d({customerName:[{required:!0,message:"客户姓名不能为空！",trigger:"blur"}],customerPhone:[{required:!0,message:"客户电话不能为空！",trigger:"blur"}],desc:[{required:!0,message:"问题描述不能为空！",trigger:"blur"}]}),y=d([]),P=d([]);ce(()=>{setTimeout(()=>{S(),G()},500)});const M=r=>{let e=r.id,o=r.neoid,u="id="+e;o!=null&&(u=u+"&neoid="+o),f.$router.push(`/problem_report_details?${u}`)},A=()=>{b.value=!0},E=()=>{for(let e in n.value)if(e!="orderNo"&&e!="fileList"&&e!="filePath"&&n.value[e]==""){f.$message.error("必填字段不能为空!");return}let r={caseNo:n.value.orderNo,name:n.value.customerName,phone:n.value.customerPhone,problemDescription:n.value.desc,picture:n.value.filePath.join(";"),caseStatus:"1"};be(r).then(e=>{let o=e.data;o.code=="success"?(n.value={orderNo:"",customerName:"",customerPhone:"",desc:"",fileList:[],filePath:[]},b.value=!1,f.$message.success("提交成功!"),S()):f.$message.error(o==null?void 0:o.message)})},S=()=>{ve({caseStatus:"",caseNo:"",name:""}).then(e=>{let o=e.data;o.code=="success"?(y.value=o.data,V.value={pageIndex:0,pageSize:100,total:o.data.length}):(f.$message.error(o==null?void 0:o.message),y.value=[],V.value={pageIndex:0,pageSize:100,total:0})})},G=()=>{ge({deliveryDate:"",status__c:"",orderType__c:"",transactionDate:"",po:"",accountName:"",accountPhone:""}).then(e=>{let o=e.data;o.code=="success"?P.value=o.data:f.$message.error(o==null?void 0:o.message)})},H=r=>{let e=P.value.find(o=>o.po==r);e&&(n.value.customerName=e.accountName,n.value.customerPhone=e.accountPhone)},J=r=>{if(console.log(r),r.code=="success"){let e=r.data.map(o=>o.fileUrl);n.value.filePath=n.value.filePath.concat(e)}},K=r=>{var e=r.response;console.log(e)},Q=r=>{C.value.files.push(r)};return(r,e)=>{const o=c("el-input"),u=c("el-form-item"),x=c("el-form"),W=c("el-date-picker"),L=c("el-option"),U=c("el-select"),v=c("el-button"),m=c("el-table-column"),X=c("el-table"),Y=c("el-pagination"),Z=c("el-icon"),ee=c("el-upload"),le=c("el-dialog");return h(),k("div",he,[Ne,s("span",Ve,[s("span",ye,[l(x,{model:i,rules:r.rule,"label-width":"80px","label-position":"left"},{default:t(()=>[l(u,{label:"问题编号"},{default:t(()=>[l(o,{placeholder:"请输入问题编号",modelValue:i.problemNo,"onUpdate:modelValue":e[0]||(e[0]=a=>i.problemNo=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"客户名称"},{default:t(()=>[l(o,{placeholder:"输入客户名称",modelValue:i.customerName,"onUpdate:modelValue":e[1]||(e[1]=a=>i.customerName=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"客户电话"},{default:t(()=>[l(o,{placeholder:"请输入客户电话",modelValue:i.customerName,"onUpdate:modelValue":e[2]||(e[2]=a=>i.customerName=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),l(x,{model:i,rules:r.rule,"label-width":"80px","label-position":"left"},{default:t(()=>[l(u,{label:"创建时间"},{default:t(()=>[l(W,{modelValue:i.createDate,"onUpdate:modelValue":e[3]||(e[3]=a=>i.createDate=a),type:"daterange","range-separator":"~","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])]),_:1}),l(u,{label:"订单状态"},{default:t(()=>[l(U,{modelValue:i.orderStatus,"onUpdate:modelValue":e[4]||(e[4]=a=>i.orderStatus=a),placeholder:"请选择订单状态"},{default:t(()=>[(h(!0),k(I,null,$(B.value,a=>(h(),R(L,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Pe]),_:1},8,["model","rules"])]),s("span",Se,[l(v,{type:"primary",onClick:S,class:"search_btn"},{icon:t(()=>[xe]),default:t(()=>[_("查询")]),_:1}),l(v,{type:"primary",class:"reset_btn"},{icon:t(()=>[we]),default:t(()=>[_("重置")]),_:1})])]),s("span",ke,[Ce,s("span",De,[l(v,{onClick:A,type:"primary",class:"search_btn"},{icon:t(()=>[Le]),default:t(()=>[_("新建")]),_:1}),l(v,{type:"primary",class:"reset_btn"},{icon:t(()=>[Ue]),default:t(()=>[_("下载")]),_:1})])]),s("span",Ie,[l(X,{class:"table_content",data:y.value,stripe:!1,style:{width:"100%"}},{default:t(()=>[l(m,{prop:"caseNo",label:"问题编号"}),l(m,{prop:"name",label:"客户姓名"}),l(m,{prop:"problemDescription",label:"问题描述"}),l(m,{prop:"sourceOfProblem",label:"来源"},{default:t(a=>{var g;return[s("div",$e,z(a.row.sourceOfProblem?(g=F.value.find(w=>w.code==a.row.sourceOfProblem))==null?void 0:g.name:""),1)]}),_:1}),l(m,{prop:"distributorName",label:"提报人"}),l(m,{prop:"actualResolutionDate",label:"创建时间"}),l(m,{prop:"caseStatus",label:"问题状态"},{default:t(a=>{var g;return[s("div",Re,z(a.row.caseStatus?(g=q.value.find(w=>w.code==a.row.caseStatus))==null?void 0:g.name:""),1)]}),_:1}),l(m,{prop:"",label:"操作",width:"80px"},{default:t(a=>[s("div",{style:{display:"flex","align-items":"center",color:"#165dff",cursor:"pointer"},onClick:g=>M(a.row)}," 查看 ",8,ze)]),_:1})]),_:1},8,["data"]),l(Y,{class:"table_pagination","page-size":V.value.pageSize,"pager-count":5,layout:"total, prev, pager, next",total:V.value.total},null,8,["page-size","total"])]),s("div",Oe,[l(le,{modelValue:b.value,"onUpdate:modelValue":e[11]||(e[11]=a=>b.value=a),title:"问题提报",width:"80%","show-close":!1},{footer:t(()=>[s("div",Ae,[l(v,{class:"cancel_btn",onClick:e[10]||(e[10]=a=>b.value=!1)},{default:t(()=>[_("取消")]),_:1}),l(v,{type:"primary",class:"primary_btn",onClick:E},{default:t(()=>[_("提交")]),_:1})])]),default:t(()=>[s("span",Te,[s("span",Be,[s("span",{class:O(D.value==1?"num_selected":"num")},"1",2),Fe]),s("span",qe,[s("span",{class:O(D.value==2?"num_selected":"num")},"2",2),je])]),s("div",Me,[l(x,{model:n.value,rules:j.value,"label-width":"90px","label-position":"left"},{default:t(()=>[l(u,{label:"订单编号",prop:"orderNo"},{default:t(()=>[l(U,{modelValue:n.value.orderNo,"onUpdate:modelValue":e[5]||(e[5]=a=>n.value.orderNo=a),filterable:"",onChange:H,placeholder:"请选择订单编号"},{default:t(()=>[(h(!0),k(I,null,$(P.value,a=>(h(),R(L,{key:a.po,label:a.po,value:a.po},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"客户姓名",prop:"customerName"},{default:t(()=>[l(o,{placeholder:"请输入客户姓名",modelValue:n.value.customerName,"onUpdate:modelValue":e[6]||(e[6]=a=>n.value.customerName=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"客户电话",prop:"customerPhone"},{default:t(()=>[l(o,{placeholder:"请输入客户电话",modelValue:n.value.customerPhone,"onUpdate:modelValue":e[7]||(e[7]=a=>n.value.customerPhone=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"问题描述",class:"customLayout",prop:"desc"},{default:t(()=>[l(o,{modelValue:n.value.desc,"onUpdate:modelValue":e[8]||(e[8]=a=>n.value.desc=a),rows:5,type:"textarea",maxlength:"500",placeholder:"请输入问题描述","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(u,{label:"上传图片",class:"custom_upload"},{default:t(()=>[l(ee,{"on-success":J,"on-remove":K,"auto-upload":!0,data:C.value,headers:T.value,"before-upload":Q,"list-type":"picture-card",class:"avatar-uploader",action:"https://sh.mengtian.com.cn:9595/md/api/common/file/upload","show-file-list":!0,"file-list":n.value.fileList,"onUpdate:fileList":e[9]||(e[9]=a=>n.value.fileList=a)},{default:t(()=>[l(Z,null,{default:t(()=>[l(me(_e))]),_:1})]),_:1},8,["data","headers","file-list"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])])])}}}),Qe=fe(Ee,[["__scopeId","data-v-3a5c786c"]]);export{Qe as default};
