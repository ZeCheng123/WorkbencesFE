import{u as y}from"./userinfo-CWw1Q2oY.js";import{w as U,s as x,l as B,a as C}from"./common-CN53Xqpj.js";import{d as D,g as F,r as c,b as J,o as M,c as g,e as u,w as d,F as O,f as h,p as R,h as N,i as p,a as f,t as T,j as G,_ as X}from"./index-Ca3ktP95.js";const Q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAYdJREFUSEu1lDFLA0EQhWcuCIIgin9AQSRBLAQbbbRNp4KFegfaaCEIlskmGNAkloIiKILh7gTRIjaKlbWNxELInljkF9gG0exIEhJNvE2yC7lyb+fbN483g9ClD7vEBS3wuJkeLRkiDEIMVYShUeAOy/wVqQyeWEkPfgXEh0+nz9xhU7VzZXDQ3EsAGrt+FgrChTc3eltpQtXjkJm8J4SwpG69ZokyOGglSSomYIzwTKSgpVgGJoQXz2aT+h5b+y4ArjarJsBDz4nuaIPLhSErdU1ASw3xEjSdv4w9aYMlqbjiDlvWzrEsakQi7Lnxh5bganFgFoDmyheJ4MRz2ZZf+1UQHnAnGmn2vB634bXEQG+p5w4AZv5fwptmT6tMyHKbLfrFrw4eM1PzBlJWZWC4w6RzUP/RalTb7YWWihXAZ9xhm+06+1VsJTcA4FRegI+I4jhvxzqyq8Ejn3EtAkCOSJx7bvyinUpp3GoLHAGKhEbuu7/v9f1o+1MFqD15nT6ivDY7Bf8ADkOHFwvZKY0AAAAASUVORK5CYII=",q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAihJREFUSEvN1E9o01AcB/Dv7yVZb0MFFQ/zMmbrpidXsEykguBBFCtOxBlF9KzCDqJdMWDrQBTBu0VMnSD4BwVRT70JdijI6hqVXRQsTLzMS9fk/ST749o1aSJSMMe87/vk9977vRA69FCHXISCtx7P7mZBoxA0SJJvb/xWv1ksGna7otrC245lexyVRplwvglhlARw42Mh/dAPb4Fjem4fWCZAYieABIBu38oIFZKYlMQlEBWte+kPy9kmOKpnhwnkW0XQeSgs+sqFS1/cXBMcO3HVAIkrQYDvOMs9lUKm+L/CVIagU2DeBObnC6v494qprEgcXd83/6k6oz0A48jfwHcrZvp0TM89A3BgZV8XUTuifCXbdtH9f8b8Ko7q2QsEurUUnFJYpFCrVZ2I9hKEIWARrXVhVrUxAfDexoN0IPs/m5nplsPbMjIeF0K+bQi/qaN+SCFVEyxeuSh1yTnHpgkGdq3qjncVM73Ds4+TSUP93qPNErBmZXn82l7bfTDy81ev1NQ6O/Z9gOMeLXe5YqbHPWH3Zexk7jEYqVUTH4HlFIRyGMzbvfqYwXHLHJv0hQfOGOucee09gM1hLwqD71jm2NnGvOdPaGDkWr8juBwOpjJrSsLKX5wLhN1AVM8OEqgUgP8Ay+HlaxwKdkO9urFBIy3f1KtLswnIS5bXrULG8vp44I8+aRhqdUY9R4wUAzEATwj8dNrMvGi3mkA43D63pjoG/waphdwXWEUOPAAAAABJRU5ErkJggg==",v=i=>(R("data-v-b3da7177"),i=i(),N(),i),j=v(()=>p("div",{class:"main"},null,-1)),K={class:"content"},Y=v(()=>p("img",{src:Q,alt:""},null,-1)),L=v(()=>p("img",{src:q,alt:""},null,-1)),P={key:0,class:"sendCode"},W=D({__name:"index",setup(i){const{proxy:s}=F(),r=c(0);y();const I=c(null),w=c(null),m=c(!0),A=c({userId:"",corpId:"",token:""}),a=J({phone:"",code:""});M(()=>{const n=window.location.href.indexOf("?"),e=n>=0?window.location.href.substring(n+1):window.location.href,t=new URLSearchParams(e).get("code");t&&(alert("wxcode:"+t),I.value=t,S())});const E=()=>{if(!a.phone){s.$message.error("手机号不能为空!");return}if(!/^1[3-9]\d{9}$/.test(a.phone)){s.$message.error("手机号不合法!");return}x({phone:a.phone}).then(e=>{e.data.code=="success"&&(r.value=60,b())})},S=async()=>new Promise(function(n){U({code:I.value,userType:2}).then(e=>{let o=e.data;if(o.code=="success"){let t=o.data||{};A.value=t,alert("userInfo:"+JSON.stringify(t)),A.value.token?(localStorage.setItem("token",t.token),sessionStorage.setItem("token",t.token),s.$router.push({path:"/main",query:{}})):m.value=!0}n(!0)})}),k=()=>{if(!a.phone){s.$message.error("手机号不能为空!");return}if(!/^1[3-9]\d{9}$/.test(a.phone)){s.$message.error("手机号不合法!");return}if(!a.code){s.$message.error("验证码不能为空!");return}B({phone:a.phone,captcha:a.code,userType:2}).then(e=>{let o=e.data;if(alert(JSON.stringify(o)),o.code=="success"){let t=o.data||{};_(t),s.$router.push("/main")}else s.$message.error(e==null?void 0:e.message)})},_=async n=>{let e={id:n.id,neoId:n.neoId,phone:n.phone,name:n.phone,corpId:A.value.corpId,userId:A.value.userId,userType:2};alert("新增用户接口参数:"+JSON.stringify(e)),C(e).then(o=>{var t;alert(JSON.stringify(o.data)),((t=o==null?void 0:o.data)==null?void 0:t.code)=="success"?S():console.log("失败")}).catch(o=>{alert("新增失败!"),console.error("新增失败:",o)})},b=()=>{w.value=setInterval(()=>{r.value>0?r.value-=1:clearInterval(w.value)},1e3)};return(n,e)=>{const o=h("el-input"),t=h("el-button"),V=h("el-dialog");return f(),g(O,null,[j,u(V,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=l=>m.value=l),title:"登录","close-on-click-modal":!1,"show-close":!1},{default:d(()=>[p("div",K,[u(o,{class:"phone",placeholder:"请输入手机号",modelValue:a.phone,"onUpdate:modelValue":e[0]||(e[0]=l=>a.phone=l)},{prepend:d(()=>[Y]),_:1},8,["modelValue"]),u(o,{class:"code",placeholder:"请输入验证码",modelValue:a.code,"onUpdate:modelValue":e[1]||(e[1]=l=>a.code=l)},{prepend:d(()=>[L]),append:d(()=>[r.value>0?(f(),g("span",P,T(r.value)+"s",1)):(f(),g("span",{key:1,class:"sendCode",onClick:E},"发送验证码"))]),_:1},8,["modelValue"]),u(t,{class:"login_btn",onClick:k},{default:d(()=>[G("登录")]),_:1})])]),_:1},8,["modelValue"])],64)}}}),$=X(W,[["__scopeId","data-v-b3da7177"]]);export{$ as default};
